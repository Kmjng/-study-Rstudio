#############################################
# 단계1 : 표본평균의 표본오차 (ppt.28)  
#############################################
# 표본오차 : 모수 추정 시 표본의 통계량과 모수 간의 필연적인 차이(error)  
# 오차범위 : 표본오차가 발생할 범위(예 : ±표본오차) 

# 신뢰수준 : 표본으로 추정한 값을 신뢰할 수 있는 정도(통상 : 95%)
# 유의수준 : 표본으로 추정한 값을 신뢰할 수 없는 정도(통상 : 5%)
# 신뢰수준(95%) = 1 - 유의수준(5%) 
# 신뢰구간 : 신뢰수준 하에서 모수가 포함될 범위(하한값,상한값)


# 1) 표본오차(e) = ±Z값 * 표준오차

# [가정] 박찬호 투수 평균구속 150~160구간에 포함될 확률 95% 일때

# [1] 표본추출 
sample <- rnorm(n=100, mean = 155, sd=5) # N(155, 5^2)
sample  

sigma = 5 # 모표준편차 
n = 100 # 표본수

# [2] 표준오차(SE)=모표준편차/sqrt(n)  
SE = sigma/sqrt(n) # 0.5

Z = 1.96 # 95% 신뢰수준 z값 

# [3] 표본오차(Sampling Error) 
e = Z * SE 
e # ±0.98 


#############################################
# 단계2 : 모평균의 신뢰구간 추정(ppt.31)  
#############################################
# 표본오차를 인정하여 모평균의 신뢰구간 추정

# 추정식 : 표본평균-표본오차(e) < 모평균 < 표본평균+표본오차(e) 

# [사례1] 중2 남학생 평균키를 알아보기 위해서 100명을 표본으로 
# 평균키=167.5cm, 표준편차=5.5cm로 나왔다. 95% 신뢰수준에서 
# 모평균의 신뢰구간을 구하시오.(z분포)


# 단계1 : 표본오차(e) 계산 
z = 1.96 # Z값(95% 신뢰수준 1.96)
n = 100 # 표본수
SE = 5.5 / sqrt(n) # 표준오차
e = z * SE # 표준오차  
e # 1.078


# 단계2 : 모평균 신뢰구간 
x_bar = 167.5 # 표본평균 
minvalue = x_bar - e 
maxvalue = x_bar + e 
minvalue; maxvalue # 신뢰구간 : (166.422, 168.578)


# [사례2] 중2 남학생 평균키를 알아보기 위해서 28명을 표본으로 
# 평균키=167.5cm, 표준편차=5.5cm로 나왔다. 95% 신뢰수준에서 
# 모평균의 신뢰구간을 구하시오.(t분포)

# 단계1 : 표본오차(e) 계산 
t = 2.052 # t값(T분포표 참조)
x_bar = 167.5 # 표본 평균 
S = 5.5 # 표본의 표준편차 
n = 28 # 표본수 
SE = 5.5 / sqrt(n) # 표준오차
e = t * SE # 표본오차 
e #  2.13285


# 단계2 : 모평균 신뢰구간 
minvalue = x_bar - e 
maxvalue = x_bar + e 
minvalue; maxvalue # 신뢰구간 : (165.3671, 169.6329)

