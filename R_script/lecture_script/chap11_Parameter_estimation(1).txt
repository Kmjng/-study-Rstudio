# chap11_Parameter_estimation 

# 모수 추정(모수 신뢰구간 추정)  

#############################################
# 표본 크기 (ppt.9) 
#############################################
# 모집단크기, 신뢰수준, 응답비율, 표본오차를 이용하여 표본 크기를 알 수 있다.  
# N : 모집단의 크기
# Z : 신뢰수준의 Z값(95%일 때 1.96)
# p : 모집단 응답비율(통상 0.5)
# e : 표본오차 : 표본통계량과 모평균 차이(Error) 
# n : 표본크기


#예) 전체 100만명의 유권자를 대상으로 표본조사한 결과 후보A의 지지율이 50%로  
#      알려진 경우 표본오차는 ±3%이고, 신뢰수준은 95%일 때  표본의 크기는?

N = 1000000 
z = 1.96 # 표준화점수 
p = 0.5 # 모집단 응답비율
e = 0.03 # 표본오차(Sample Error)=Z값*표준오차(SE) 

x = (z^2 * (p*(1-p)) / e^2)
y = (1 + ( (z^2 * (p*(1-p))) / (e^2*N) ))
n <- x / y
n # 1065.974 -> 1,066명



#############################################
# 중심극한정리와 표준오차(ppt.11~12)  
#############################################
# 중심극한정리 : 추출된 ‘표본의 크기 n이 충분히 크다’면 표본평균들이 이루는 분포는
# ‘평균과 표준편차가 정규분포‘에 근접하다는 이론

# 표준오차(Standard Error) : 표본평균들의 표준편차(모평균과의 차이) 
# SE = sqrt(sigma^2 / n)  # 모분산(sigma^2) 알고 있는 경우 
# SE = sqrt(S^2 / n)  # 표본 분산(S^2) 이용 하는 경우  


# 예) 성인남자 키를 모집단으로 한 모평균(mu)=173.5, 모표준편차(sigma)=5.5인 경우
set.seed(123)
pop = rnorm(10000, mean = 173.3, sd=3) # 키 모집단
hist(pop)

# 표본 100번 반복추출 
n = 100 # 시행횟수 
sample_mean = c() # 표본평균 

# 모집단(pop)에서 30개씩 100번 반복 
for(i in 1:n){  
  idx = sample(len(pop), size=30, replace=TRUE)# 각 시행 30개씩   
  s <- pop[idx]
  sample_mean <- c(sample_mean, mean(s)) # 표본평균 추가 
}

length(sample_mean) # 표본크기 

# 표본통계량 : 평균,표준편차  
mean(means) 
sd(means)  

# 표본분포 : 정규분포 근접
hist(means)

# 표준오차(SE) 계산 : ppt.12 참고  

