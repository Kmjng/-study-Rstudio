#############################################
# 정규분포 : ppt.23
#############################################
# 정규분포 : 좌우 대칭인 종모양의 연속확률분포  
# - 확률분포곡선(도수분포곡선)이 평균값을 중심으로 좌우대칭인 종 모양

set.seed(12)
height <- rnorm(n=1000, mean = 175, sd = 5)
height

# 1) 각 계급을 밀도단위로 나타냄 
hist(height, freq = FALSE) # 밀도단위 


# 2) 확률밀도함수(PDF) : : 확률변수X의 크기(확률밀도) 추정  
pdf <- density(height) # 커널밀도추정(KDE) : 적분값으로 확률밀도 추정   


# 3) 확률밀도분포곡선 : 추정된 대역폭과 x,y 통계로 분포곡선 시각화  
lines(pdf, col='red')


# 4) 정규분포곡선 추가 
x <- seq(159, 191, 0.1)
curve(dnorm(x, mean=mean(height), sd=sd(height)),
      col='blue', add = TRUE)

# 범례 추가 
legend(x=185, y=0.08, legend = "N(175,5^2)",
       fill='blue')


#########################################
## 표준정규분포 : ppt.33 
#########################################
# 표준정규분포(z분포) 
# - 모든 정규분포를 평균=0, 표준편차=1 로 표준화한 분포
# - 표준화공식 z = (X - mu) / sigma 


# 1) 정규분포 표본 추출 
n <- 1000
x <- rnorm(n, mean = 100, sd= 5) # 확률변수 x 

# 정규분포의 밀도분포곡선(확률밀도함수 이용) 
library(lattice)
densityplot( ~ x, col='red')

# 정규성 검정 : 귀무가설(H0) : 정규분포와 차이가 없다. 
shapiro.test(x) 


# 2) 표준정규분포 변환 : 표준화공식 z    
mu = mean(x) # 그리스 알파벳(모평균) 
z = (x - mu) / sd(x)

mean(z)
sd(z)


# 3) 표준편차 vs 확률 관계(ppt.35) 
# -1 ~ +1        68.26%
# -2 ~ +2        95.44%
# -3 ~ +3        99.74%
