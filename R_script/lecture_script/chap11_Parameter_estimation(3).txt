#############################################
# 단계1 : 표본비율의 표본오차 (ppt.38)  
#############################################

# [가정] 성인남녀 1000명을 대상으로 한 여론조사에서 응답률
# 10% 조사환경에서 대통령의 국정운영 지지율이 30% 일 때 
# 95% 신뢰수준에서 오차범위(표본오차)

n = 1000 # 표본수 
p = 0.3 # 성공확률 
z = 1.96

SE = z * sqrt(p*(1-p)/ n)
SE # 0.0284031 -> ±3%


#############################################
# 단계2 : 모비율의 신뢰구간 추정(ppt.40)  
#############################################

# [사례1] A 여론조사기관에서 20~30대 연령의 남녀 800명을 대상으로 
# 사내 커플 경험이 있는지를 조사한 결과 전체의 56.7%가 그런 경험이 
# 있다고 답을했을 때, 95% 신뢰수준에서 모평균의 신뢰구간(z분포)

# 단계1 : 표본오차(e) 계산 
p = 0.567
n = 800
z = 1.96# (95% 신뢰수준)

e = z * sqrt(p*(1-p) / n) # 0.03433575

# 단계2 : 모비율 신뢰구간 
minvalue = p - e
maxvalue = p + e 
minvalue; maxvalue # 신뢰구간 : (0.5326642, 0.6013358)
 

# [사례2] A 여론조사기관에서 20~30대 연령의 남녀 28명을 대상으로 사내 커플 
#경험이 있는지를 조사한 결과 전체의 56.7%가 그런 경험이 있다고 답을
#했을 때, 95% 신뢰수준에서 모평균의 신뢰구간을 구하시오.(t분포)

# 단계1 : 표본오차(e) 계산 
p = 0.567
n = 28
t = 2.052 # (T분포표 : 자유도, 유의수준)

e = t * sqrt(p*(1-p) / n) 

# 단계2 : 모비율 신뢰구간 
minvalue = p - e
maxvalue = p + e 
minvalue; maxvalue # 신뢰구간 : (0.3748529, 0.7591471)
# [해설] 표본수가 작을 수록 신뢰구간은 넓어진다. 
