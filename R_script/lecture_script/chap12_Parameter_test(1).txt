# chap12_Parameter_test 

# 모수 검정(모수 유의성 검정)

############################################
### 1. Z분포와 검정(ppt.29~30)  
############################################
# - 모집단 정규분포이고, 모집단의 분산(표준편차)이 알려진 경우
# - 표본의 크기가 충분히 큰 경우(n >= 30)
# - 표본의 평균과 모평균의 차이 검정


# [가정]
# 우리나라 중2 남학생은은 평균키=168cm, 표준편차=3cm 알려질 때 
# 표본 100명을 대상으로 95% 신뢰수준에서 모평균 검정 

# 귀무가설(HO) : 모평균 168cm와 차이가 없다.(𝜇= 168cm)
# 대립가설(H1) : 모평균 168cm와 차이가 있다.(𝜇≠ 168cm)

# 단계1. 표본 추출 : 모집단에서 100명 표본 추출 
set.seed(10)
x <- rnorm(50, mean=168, sd = 3) # N(168, 3^2) 
hist(x) # 좌우 대칭 분포 
mean(x) # 표본평균
sd(x) # 표본표준편차 


# 단계2. 정규성 검정   
shapiro.test(x) # 정규성검정 : 기본 가정 충족 


# 단계3. Z검정 
install.packages('BSDA') # z.test() 제공 
library(BSDA)

# 95% 신뢰수준(유의수준 %5)에서 양측검정  
z.test(x, alternative = 'two.sided', mu=168, 
       sigma.x = 3, conf.level = 0.95)


# 단계4. z값(z검정통계량) 
x_bar <- mean(x) # 표본 평균 
mu <- 168 # 모평균 
sigma <- 3  # 모표준편차(모분산)
n <- length(x) # 표본수 

z_value <- (x_bar - mu) / (sigma / sqrt(n)) # z값


# 단계5. 가설검정 : 양측검정(대립가설 기준)
# [방법1] z값 해석 : 95% 신뢰수준에서 z값이 ±1.96 사이에 있는 경우 채택   
# [방법2] p-vale 해석 : p-value > 유의순(0.05) 이면 채택  

z_level = 1.96 # z 임계값(95%신뢰수준의 양측검정)

# z값과 z임계값(1.96) 관계
# -1.96 < z_value < +1.96 : 채택역 

-z_level < z_value & z_value < z_level # TRUE : 채택 


# 단계6. 가설검정 결과 해설 : 채택 or 기각
# [해설] 95% 신뢰수준에서 z검정을 수행한 결과 z통계량=-2.645241, 
# z임계값= ±1.96(95%확률) 이므로 z통계량은 임계값 영역에 벗어나므로
# 가설을 기각할 수 있다.


######################################
### z검정의 단측검정 예
######################################

# 1) 좌측검정
# 귀무가설(HO) : 모평균 168cm와 차이가 없다.(𝜇= 168cm)
# 대립가설(H1) : 모평균 168cm 보다 작다.(𝜇 < 168cm) : 평균보다 작은 경우

# 95% 신뢰수준(유의수준 %5)에서 좌측검정  
z.test(x, alternative = 'less', mu=168, 
       sigma.x = 3, conf.level = 0.95)


# 2) 우측검정 
# 귀무가설(HO) : 모평균 168cm와 차이가 없다.(𝜇= 168cm)
# 대립가설(H1) : 모평균 168cm 보다 크다.(𝜇 > 168cm) : 평균보다 큰 경우

# 95% 신뢰수준(유의수준 %5)에서 우측검정  
z.test(x, alternative = 'greater', mu=168, 
       sigma.x = 3, conf.level = 0.95)

